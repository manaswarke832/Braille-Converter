<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Braille Converter - Text to Braille Unicode</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/tesseract.js@v2.1.0/dist/tesseract.min.js"></script>
</head>
<body>
    <header class="header">
        <h1>­Ъћц Braille Converter</h1>
    </header>

    <div class="nav-tabs">
        <button class="nav-tab active" data-panel="home">­ЪЈа Home</button>
        <button class="nav-tab" data-panel="converter">­Ъћц Converter</button>
        <button class="nav-tab" data-panel="output">Ра┐ Output</button>
    </div>

    <div class="container">
        <!-- Home Panel -->
        <div class="panel active" id="home-panel">
            <h2>­Ъћц Welcome to Braille Converter</h2>
            <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=250&fit=crop" alt="Braille reading" class="hero-image">
            
            <p class="info-text">
                Transform any text into Braille Unicode instantly. Our tool supports multiple input methods including typing, speech-to-text, and image OCR to make Braille conversion accessible to everyone.
            </p>

            <div class="braille-images">
                <img src="https://images.unsplash.com/photo-1589998059171-988d887df646?w=150&h=120&fit=crop" alt="Braille dots" class="braille-image">
                <img src="https://images.unsplash.com/photo-1516321318423-f06f85e504b3?w=150&h=120&fit=crop" alt="Braille book" class="braille-image">
                <img src="https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=150&h=120&fit=crop" alt="Accessibility" class="braille-image">
                <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=150&h=120&fit=crop" alt="Reading Braille" class="braille-image">
            </div>

            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn btn-primary" onclick="showPanel('converter')">
                    ­Ъџђ Start Converting
                </button>
            </div>
        </div>

        <!-- Converter Panel -->
        <div class="panel" id="converter-panel">
            <h2>­ЪЊЮ Input Text</h2>
            <div class="input-section">
                <div class="input-group">
                    <label for="textInput">Type or paste your text:</label>
                    <textarea id="textInput" placeholder="Enter text to convert to Braille..."></textarea>
                </div>

                <div class="input-options">
                    <button class="btn btn-secondary" id="speechBtn">
                        ­Ъјц Speech to Text
                    </button>
                    <div class="file-upload">
                        <input type="file" id="imageInput" accept="image/*">
                        <div class="upload-area" id="uploadArea">
                            ­ЪЊи Upload Image (OCR)
                        </div>
                    </div>
                </div>

                <div id="status"></div>

                <button class="btn btn-primary convert-btn" id="convertBtn">
                    ­Ъћё Convert to Braille
                </button>
            </div>
        </div>

        <!-- Output Panel -->
        <div class="panel" id="output-panel">
            <h2>Ра┐ Braille Output</h2>
            <div class="output-section">
                <div class="braille-output empty" id="brailleOutput">
                    Braille output will appear here...
                </div>

                <div class="output-actions">
                    <button class="btn btn-success" id="copyBtn" disabled>
                        ­ЪЊІ Copy
                    </button>
                    <button class="btn btn-warning" id="speakBtn" disabled>
                        ­Ъћі Speak
                    </button>
                    <button class="btn btn-secondary" id="downloadBtn" disabled>
                        ­ЪњЙ Download
                    </button>
                    <button class="btn btn-primary" id="printBtn" disabled>
                        ­Ъќе№ИЈ Print
                    </button>
                </div>

                <div id="unsupportedChars"></div>
            </div>
        </div>
    </div>

    <script>
        // Braille Unicode mapping
        const brailleMap = {
            'a': 'РаЂ', 'b': 'РаЃ', 'c': 'РаЅ', 'd': 'РаЎ', 'e': 'РаЉ', 'f': 'РаІ',
            'g': 'РаЏ', 'h': 'РаЊ', 'i': 'Раі', 'j': 'Раџ', 'k': 'РаЁ', 'l': 'РаЄ',
            'm': 'РаЇ', 'n': 'РаЮ', 'o': 'РаЋ', 'p': 'РаЈ', 'q': 'РаЪ', 'r': 'РаЌ',
            's': 'Рај', 't': 'Раъ', 'u': 'РаЦ', 'v': 'РаД', 'w': 'Ра║', 'x': 'РаГ',
            'y': 'Рай', 'z': 'Рах',
            'A': 'РаЂ', 'B': 'РаЃ', 'C': 'РаЅ', 'D': 'РаЎ', 'E': 'РаЉ', 'F': 'РаІ',
            'G': 'РаЏ', 'H': 'РаЊ', 'I': 'Раі', 'J': 'Раџ', 'K': 'РаЁ', 'L': 'РаЄ',
            'M': 'РаЇ', 'N': 'РаЮ', 'O': 'РаЋ', 'P': 'РаЈ', 'Q': 'РаЪ', 'R': 'РаЌ',
            'S': 'Рај', 'T': 'Раъ', 'U': 'РаЦ', 'V': 'РаД', 'W': 'Ра║', 'X': 'РаГ',
            'Y': 'Рай', 'Z': 'Рах',
            '0': 'Раџ', '1': 'РаЂ', '2': 'РаЃ', '3': 'РаЅ', '4': 'РаЎ', '5': 'РаЉ',
            '6': 'РаІ', '7': 'РаЏ', '8': 'РаЊ', '9': 'Раі',
            ' ': ' ', '\n': '\n', '\t': '\t',
            '.': 'Ра▓', ',': 'Раѓ', '!': 'Раќ', '?': 'Рад', ';': 'Рає', ':': 'Рањ',
            '-': 'Рац', "'": 'Раё', '"': 'РаёРаё', '(': 'РаљРаБ', ')': 'РаљРаю',
            '[': 'РаљРаБ', ']': 'РаљРаю', '{': 'РаљРаБ', '}': 'РаљРаю',
            '+': 'РаљРаќ', '=': 'РаљРаХ', '*': 'РаљРаћ', '/': 'РаљРаї', '\\': 'РаљРаА',
            '<': 'РаљРаБ', '>': 'РаљРаю', '@': 'РаљРаЂ', '#': 'РаљРа╝', '$': 'РаљРај',
            '%': 'РаљРа┤', '&': 'РаљРа»', '|': 'РаљРа┐', '~': 'РаљРаѕ', '`': 'РаљРаѕ',
            '^': 'РаљРаА', '_': 'РаљРац'
        };

        // DOM elements
        const textInput = document.getElementById('textInput');
        const speechBtn = document.getElementById('speechBtn');
        const imageInput = document.getElementById('imageInput');
        const uploadArea = document.getElementById('uploadArea');
        const convertBtn = document.getElementById('convertBtn');
        const brailleOutput = document.getElementById('brailleOutput');
        const copyBtn = document.getElementById('copyBtn');
        const speakBtn = document.getElementById('speakBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const printBtn = document.getElementById('printBtn');
        const status = document.getElementById('status');
        const unsupportedChars = document.getElementById('unsupportedChars');

        // Speech recognition
        let recognition = null;
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';
        }

        // Speech synthesis
        const synth = window.speechSynthesis;

        // Convert text to Braille
        function convertToBraille(text) {
            let braille = '';
            const unsupported = new Set();
            
            for (let char of text) {
                if (brailleMap[char] !== undefined) {
                    braille += brailleMap[char];
                } else {
                    braille += char;
                    if (char.trim() !== '') {
                        unsupported.add(char);
                    }
                }
            }
            
            return { braille, unsupported: Array.from(unsupported) };
        }

        // Update output
        function updateOutput(text) {
            const result = convertToBraille(text);
            
            if (result.braille.trim()) {
                brailleOutput.textContent = result.braille;
                brailleOutput.classList.remove('empty');
                
                // Enable output buttons
                copyBtn.disabled = false;
                speakBtn.disabled = false;
                downloadBtn.disabled = false;
                printBtn.disabled = false;
            } else {
                brailleOutput.textContent = 'Braille output will appear here...';
                brailleOutput.classList.add('empty');
                
                // Disable output buttons
                copyBtn.disabled = true;
                speakBtn.disabled = true;
                downloadBtn.disabled = true;
                printBtn.disabled = true;
            }
            
            // Show unsupported characters
            if (result.unsupported.length > 0) {
                unsupportedChars.innerHTML = `
                    <h4>Рџа№ИЈ Unsupported Characters:</h4>
                    <p>${result.unsupported.join(' ')}</p>
                `;
            } else {
                unsupportedChars.innerHTML = '';
            }
        }

        // Show status message
        function showStatus(message, type = 'info') {
            status.innerHTML = `<div class="status ${type}">${message}</div>`;
            setTimeout(() => {
                status.innerHTML = '';
            }, 5000);
        }



        // Speech to text
        if (recognition) {
            speechBtn.addEventListener('click', () => {
                if (recognition) {
                    speechBtn.innerHTML = '<span class="loading"></span> Listening...';
                    speechBtn.disabled = true;
                    
                    recognition.start();
                } else {
                    showStatus('РЮї Speech recognition not supported in this browser.', 'error');
                }
            });

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                textInput.value = transcript;
                speechBtn.innerHTML = '­Ъјц Speech to Text';
                speechBtn.disabled = false;
                showStatus('РюЁ Speech captured successfully!', 'success');
            };

            recognition.onerror = (event) => {
                speechBtn.innerHTML = '­Ъјц Speech to Text';
                speechBtn.disabled = false;
                showStatus('РЮї Speech recognition error: ' + event.error, 'error');
            };

            recognition.onend = () => {
                speechBtn.innerHTML = '­Ъјц Speech to Text';
                speechBtn.disabled = false;
            };
        } else {
            speechBtn.disabled = true;
            speechBtn.innerHTML = '­Ъјц Speech to Text (Not Supported)';
        }

        // Image upload and OCR
        imageInput.addEventListener('change', async (event) => {
            const file = event.target.files[0];
            if (file) {
                try {
                    showStatus('­Ъћё Processing image with OCR...', 'info');
                    
                    const result = await Tesseract.recognize(file, 'eng');
                    const extractedText = result.data.text.trim();
                    
                    if (extractedText) {
                        textInput.value = extractedText;
                        showStatus('РюЁ Text extracted from image successfully!', 'success');
                    } else {
                        showStatus('Рџа№ИЈ No text found in the image.', 'error');
                    }
                } catch (error) {
                    showStatus('РЮї Error processing image: ' + error.message, 'error');
                }
            }
        });

        // Drag and drop for images
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            if (files.length > 0 && files[0].type.startsWith('image/')) {
                imageInput.files = files;
                imageInput.dispatchEvent(new Event('change'));
            }
        });

        // Output actions
        copyBtn.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(brailleOutput.textContent);
                showStatus('РюЁ Braille copied to clipboard!', 'success');
            } catch (error) {
                showStatus('РЮї Failed to copy to clipboard.', 'error');
            }
        });

        speakBtn.addEventListener('click', () => {
            const text = textInput.value.trim();
            if (text && synth) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.8;
                utterance.pitch = 1;
                synth.speak(utterance);
                showStatus('­Ъћі Speaking text...', 'info');
            }
        });

        downloadBtn.addEventListener('click', () => {
            const braille = brailleOutput.textContent;
            const blob = new Blob([braille], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'braille_output.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showStatus('РюЁ Braille downloaded as text file!', 'success');
        });

        printBtn.addEventListener('click', () => {
            window.print();
        });

        // Real-time conversion on input
        textInput.addEventListener('input', () => {
            const text = textInput.value.trim();
            if (text) {
                updateOutput(text);
            } else {
                brailleOutput.textContent = 'Braille output will appear here...';
                brailleOutput.classList.add('empty');
                copyBtn.disabled = true;
                speakBtn.disabled = true;
                downloadBtn.disabled = true;
                printBtn.disabled = true;
                unsupportedChars.innerHTML = '';
            }
        });

        // Navigation functionality
        function showPanel(panelName) {
            // Hide all panels
            document.querySelectorAll('.panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected panel
            const targetPanel = document.getElementById(panelName + '-panel');
            if (targetPanel) {
                targetPanel.classList.add('active');
            }
            
            // Add active class to clicked tab
            const activeTab = document.querySelector(`[data-panel="${panelName}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }
        }

        // Add event listeners to navigation tabs
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const panelName = tab.getAttribute('data-panel');
                showPanel(panelName);
            });
        });

        // Auto-switch to output panel when conversion is successful
        function switchToOutput() {
            showPanel('output');
        }

        // Update convert button to switch to output panel
        convertBtn.addEventListener('click', () => {
            const text = textInput.value.trim();
            if (text) {
                updateOutput(text);
                showStatus('РюЁ Text converted to Braille successfully!', 'success');
                setTimeout(switchToOutput, 1000); // Switch to output panel after 1 second
            } else {
                showStatus('Рџа№ИЈ Please enter some text to convert.', 'error');
            }
        });

        // Initialize
        showStatus('­Ъџђ Braille Converter ready! Enter text, use speech, or upload an image.', 'info');
    </script>
</body>
</html>
